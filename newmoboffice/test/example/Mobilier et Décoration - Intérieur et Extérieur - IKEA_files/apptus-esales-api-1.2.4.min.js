/*!
 *  
 *  Apptus eSales Web-API JavaScript Library v1.2.4
 * 
 *  This script uses first-party cookies.
 *  When the user accesses the site a persistent cookie is set. This cookie does not contain personally identifiable information
 *  and it is used to provide personalization.
 * 
 *  The EU ePrivacy directive – more specifically Article 5(3) – requires the site visitor in Member States to agree to the use of
 *  such cookies before the site starts to use them.
 * 
 *  http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:32002L0058:EN:HTML
 * 
 * 
 * 
 * 
 *  Copyright (c) 2015 Apptus Technologies AB
 * 
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the "Software"), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 * 
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 * 
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 *  
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("apptus",[],e):"object"==typeof exports?exports.apptus=e():t.apptus=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(3),i=function(t){var e=function(e,r){var i=new n.a;try{var o=new XMLHttpRequest;i.result.setRequest(o),o.open(e,t,!0),r&&o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(r),o.onreadystatechange=function(){if(4===o.readyState)if(2===Math.floor(o.status/100)||1223===o.status){var t=null;o.responseText&&(t=JSON.parse(o.responseText)),i.result.setSuccessData(t)}else i.result.setErrorStatusAndData(o.status,o.responseText)}}catch(t){i.result.setErrorData(t)}return i};return{get:function(){return e("GET")},post:function(t){return e("POST",t)}}}},function(t,e,r){"use strict";function n(t){return t.map(function(t){return i(t)})}function i(t){var e=["\\",":",","],r=new RegExp("["+e.join("\\")+"]","g");return t.replace(r,"\\$&")}function o(t){var e=["\\","'"],r=new RegExp("["+e.join("\\")+"]","g");return t.replace(r,"\\$&")}e.a=n,e.b=o},function(t,e,r){"use strict";function n(t,e,r){return new u.a(d,p,i.a,t,e,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.esales=n,r.d(e,"utils",function(){return y});var i=r(0),o=r(5),s=r(6),u=r(7),a=r(9),c=r(10),f=r(11),h=r(17);r.d(e,"ajaxRequest",function(){return i.a}),r.d(e,"EsalesWebAPI",function(){return u.a});var p=new c.a(new s.a(document,"apptus.queue"),a.a),d=new o.a(document,location,window.crypto||window.msCrypto),y={FilterBuilder:f.a,Facet:h.a}},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(4),i=function(){function t(){this.result=new n.a}return t.prototype.success=function(t){return this.result.setSuccessCallback(t),this},t.prototype.error=function(t){return this.result.setErrorCallback(t),this},t.prototype.abort=function(){this.result.getRequest().abort()},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(){}return t.prototype.setSuccessData=function(t){this.successData=t,this.successCb&&this.successCb(this.successData)},t.prototype.setSuccessCallback=function(t){this.successCb=t,this.successData&&this.successCb(this.successData)},t.prototype.setErrorData=function(t){t||(t="An unknown error occurred. Please check that a valid URL was requested."),this.errorData=t,this.errorCb&&this.errorCb(this.errorData)},t.prototype.setErrorStatusAndData=function(t,e){this.errorStatus=t,0===t?e="Aborted":e||(e="An unknown error occurred. Please check that a valid URL was requested."),this.errorData=e,this.errorCb&&this.errorCb(this.errorData,this.errorStatus)},t.prototype.setErrorCallback=function(t){this.errorCb=t,this.errorData&&this.errorCb(this.errorData,this.errorStatus)},t.prototype.setRequest=function(t){this.request=t},t.prototype.getRequest=function(){return this.request},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e,r){this.doc=t,this.loc=e,this.crypto=r,this.COOKIE_NS="apptus"}return t.prototype.getRandomHexArray=function(){var t=[];if("object"==typeof this.crypto&&"function"==typeof this.crypto.getRandomValues){var e=new Uint8Array(31);this.crypto.getRandomValues(e);for(var r=0;r<e.length;r++)t.push(e[r]%16)}else for(var r=0;r<31;r++)t.push(16*Math.random()||0);return t},t.prototype.uuid=function(){var t=this.getRandomHexArray(),e=0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=t[e++];return("x"===r?n:n&&3||8).toString(16)})},t.prototype.splitInTwoOn=function(t,e){var r=t.split(e);return r.length>2&&(r=[r.shift(),r.join(e)]),r},t.prototype.getCookie=function(t){for(var e=this.doc.cookie.split(/\s*;\s*/),r=0,n=e;r<n.length;r++){var i=n[r],o=this.splitInTwoOn(i,"="),s=this.splitInTwoOn(o[0],".");if(2===s.length&&s[0]===this.COOKIE_NS&&s[1]===t)return o[1]}return null},t.prototype.setCookie=function(t,e,r){var n=this.COOKIE_NS+"."+t+"="+e+";path=/";r&&(n+="; expires="+r),this.doc.cookie=n},t.prototype.resetSessionKey=function(){return this.sessionKey(this.uuid())},t.prototype.resetCustomerKey=function(){return this.customerKey(this.uuid())},t.prototype.sessionKey=function(t){if(t)return this.setCookie("sessionKey",t),t;var e=this.getCookie("sessionKey");return e||(e=this.uuid(),this.setCookie("sessionKey",e)),e},t.prototype.customerKey=function(t){if(t)return this.setCookie("customerKey",t,i()),t;var e=this.getCookie("customerKey");return e?this.setCookie("customerKey",e,i()):(e=this.uuid(),this.setCookie("customerKey",e,i())),e},t.prototype.token=function(){return this.getCookie("token")},t}(),i=function(){var t=new Date;return t.setTime(t.getTime()+31536e6),t.toUTCString()}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e){this.doc=t,this.queueName=e,this.queueName=e||"ApptusEsales"}return t.prototype.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},t.prototype.load=function(){for(var t=this.doc.cookie.split(";"),e=0,r=t;e<r.length;e++){var n=r[e],i=n.split("=");if(2===i.length){var o=this.trim(i[0]),s=this.trim(i[1]);if(o===this.queueName)return JSON.parse(decodeURIComponent(s))}}return[]},t.prototype.save=function(t){for(var e=[],r="",n=0,i=t;n<i.length;n++){var o=i[n];e.push(o)}do{var s=encodeURIComponent(JSON.stringify(e));r=this.queueName+"="+s+";Path=/;Version=1"}while(r.length>1024&&e.shift());this.doc.cookie=r},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(8),i=function(){function t(t,e,r,i,o,s){if(this.cookies=t,this.queue=e,this.ajaxRequest=r,this.webApiId=i,this.market=o,this.alternativeBaseUrl=s,this.userAgent=new n.a,void 0===i)throw new Error("webApiId must be defined.");if(void 0===o)throw new Error("market must be defined.");this.baseURL=null===s||void 0===s?"https://"+i+".api.esales.apptus.cloud/api/v1":s+"/clusters/"+i,this.savedSessionKey=t.sessionKey(),this.savedCustomerKey=t.customerKey(),this.token=t.token()}return t.prototype.toQueryParamString=function(t,e,r,n,i,o){var s=[];if(t&&s.push("sessionKey="+encodeURIComponent(t)),e&&s.push("customerKey="+encodeURIComponent(e)),r&&s.push("market="+encodeURIComponent(r)),n&&s.push("token="+encodeURIComponent(n)),i)for(var u in i)i.hasOwnProperty(u)&&s.push("arg."+u+"="+encodeURIComponent(i[u]));return o&&s.push("nameToken="+encodeURIComponent(o)),"?"+s.join("&")},t.prototype.sessionKey=function(t){return this.savedSessionKey=this.cookies.sessionKey(t),this},t.prototype.customerKey=function(t){return this.savedCustomerKey=this.cookies.customerKey(t),this},t.prototype.panel=function(t){var e=this;return{fetch:function(r){return e.userAgent.isBot()&&(void 0===r&&(r={}),r.notify=!1),e.ajaxRequest(e.baseURL+"/panels"+t+e.toQueryParamString(e.savedSessionKey,e.savedCustomerKey,e.market,e.token,r)).get()}}},t.prototype.dynamicPage=function(t,e){var r=this;if(void 0===t)throw new Error("Dynamic page name is required.");if(void 0===e)throw new Error("Dynamic page name token is required.");var n=[],i={subpanel:function(t,e,r,o){if(void 0===t)throw new Error("Subpanel name is required.");if(void 0===e)throw new Error("Subpanel name token is required.");if(void 0===r)throw new Error("Subpanel panel is required.");return n.push({name:t,nameToken:e,panel:r,arguments:o}),i},fetch:function(i){if(0===n.length)throw new Error("At least one subpanel must be added.");return r.userAgent.isBot()&&(void 0===i&&(i={}),i.notify=!1),r.ajaxRequest(r.baseURL+"/dynamic-pages/"+t+r.toQueryParamString(r.savedSessionKey,r.savedCustomerKey,r.market,r.token,i,e)).post(JSON.stringify(n))}};return i},t.prototype.newPaymentNotification=function(){var t=this,e={sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token,lines:[]},r=function(t){var e={quantity:function(r){var n=Number(r);if(n>2147483647)throw new Error("Quantity must not be larger than 2147483647");if(n<1)throw new Error("Quantity must be a positive integer.");var i=n.toFixed(0);if(Number(i)!==n)throw new Error("Quantity must be an integer.");return t.quantity=r,e},unitSellingPrice:function(r){if("number"!=typeof r)throw new Error("Current selling price must be a number.");return t.sellingPrice=r,e}};return e};return{addProduct:function(t){var n={productKey:t};return e.lines.push(n),r(n)},addVariant:function(t){var n={variantKey:t};return e.lines.push(n),r(n)},addProductWithVariant:function(t,n){var i={productKey:t,variantKey:n};return e.lines.push(i),r(i)},send:function(){return t.ajaxRequest(t.baseURL+"/notifications/payment").post(JSON.stringify(e))}}},t.prototype.notifyClick=function(t){this.queue.add({id:Math.random().toString(36),url:this.baseURL+"/notifications/click",sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token,ticket:t})},t.prototype.notifyNonEsalesClick=function(t,e){this.queue.add({id:Math.random().toString(36),url:this.baseURL+"/notifications/non-esales-click",sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token,productKey:t,variantKey:e})},t.prototype.notifyAddingToCart=function(t){this.queue.add({id:Math.random().toString(36),url:this.baseURL+"/notifications/adding-to-cart",sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token,ticket:t})},t.prototype.notifyNonEsalesAddingToCart=function(t,e){this.queue.add({id:Math.random().toString(36),url:this.baseURL+"/notifications/non-esales-adding-to-cart",sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token,productKey:t,variantKey:e})},t.prototype.endSession=function(){var t={sessionKey:this.savedSessionKey,customerKey:this.savedCustomerKey,market:this.market,token:this.token};this.savedSessionKey=this.cookies.resetSessionKey(),this.savedCustomerKey=this.cookies.resetCustomerKey(),this.ajaxRequest(this.baseURL+"/notifications/end").post(JSON.stringify(t))},t}()},function(t,e,r){"use strict";var n=function(){function t(){this.DISALLOWED_BOT_LIST=["Googlebot","Google","Bingbot","Slurp","Baiduspider","YandexBot","Apptus","Sogou","Exabot","Facebot","facebookexternalhit","ia_archiver","bot","crawl","scrape"],this.regex=new RegExp("("+this.DISALLOWED_BOT_LIST.join("|")+")","ig")}return t.prototype.get=function(){return window.navigator.userAgent},t.prototype.isBot=function(){return this.regex.lastIndex=0,this.regex.test(this.get())},t}();e.a=n},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var n=r(0),i=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&(r[n[i]]=t[n[i]]);return r},o=500,s=function(t,e,r){var s=t.url,u=i(t,["url"]);Object(n.a)(s).post(JSON.stringify(u)).success(e).error(function(t,n){n&&n>=400&&n<500?e():(setTimeout(r,o),o*=2)})}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e){this.cookieStorage=t,this.queueRunner=e,this.items=t.load(),this.run()}return t.prototype.run=function(){var t=this;if(0!==this.items.length){var e=function(){t.items.shift(),t.cookieStorage.save(t.items),t.run()},r=function(){t.run()};this.queueRunner(this.items[0],e,r)}},t.prototype.add=function(t){this.items.push(t),this.cookieStorage.save(this.items),1===this.items.length&&this.run()},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(12),i=r(13),o=r(14),s=r(15),u=r(16),a=function(){function t(){}return t.prototype.attribute=function(t,e,r){return void 0===r&&(r=!1),new i.a(t,e,r)},t.prototype.range=function(t,e,r,i,o){return void 0===i&&(i=!0),void 0===o&&(o=!0),new n.a(t,e,r,i,o)},t.prototype.and=function(t){return new o.a(t)},t.prototype.or=function(t){return new s.a(t)},t.prototype.not=function(t){return new u.a(t)},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(1),i=function(){function t(t,e,r,i,o){if(void 0===i&&(i=!0),void 0===o&&(o=!0),this.from=e,this.to=r,this.includeFrom=i,this.includeTo=o,!t||0===t.length)throw new Error("attributes must be defined and be more than one");if(null==e||null==r)throw new Error("from and to can't be null");if(isNaN(parseInt(e.toString(),10))||isNaN(parseInt(r.toString(),10)))throw new Error("from and to must be numbers");this.attributes=Object(n.a)(Array.isArray(t)?t:[t])}return t.prototype.toString=function(){return this.attributes.join(",")+":"+(this.includeFrom?"[":"(")+"'"+this.from+"','"+this.to+"'"+(this.includeTo?"]":")")},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(1),i=function(){function t(t,e,r){if(this.value=e,this.incremental=r,!t||0===t.length)throw new Error("attributes must be defined and have atleast one attribute");if(null==e)throw new Error("value can't be null");this.value=Object(n.b)(e),this.attributes=Object(n.a)(Array.isArray(t)?t:[t])}return t.prototype.toString=function(){return this.attributes.join(",")+(this.incremental?"*":"")+":'"+this.value+"'"},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t){if(this.filters=t,!t||t.length<1)throw new Error("filters must be defined and have more than one filter")}return t.prototype.toString=function(){return"("+this.filters.map(function(t){return t.toString()}).join(" AND ")+")"},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t){if(this.filters=t,!t||t.length<1)throw new Error("filters must be defined and have atleast one filter")}return t.prototype.toString=function(){return"("+this.filters.map(function(t){return t.toString()}).join(" OR ")+")"},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t){if(this.filter=t,!t)throw new Error("filter must be defined")}return t.prototype.toString=function(){return"NOT "+this.filter.toString()},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(18),i=r(19),o=function(){function t(){this.facets=[]}return t.prototype.add=function(t,e){if(!t)throw new Error("Attribute name must be at least one character");t=this.escape(t);var r=Array.isArray(e)?this.escapeArray(e):this.escapeArray([e]),i=this.facets.map(function(t){return t.attribute}).indexOf(t);if(i>-1){if(!(this.facets[i]instanceof n.a))throw new Error("Cannot combine piped list and ranges of the same attribute");this.facets[i].addValues(r)}else this.facets.push(new n.a(t,r));return this},t.prototype.addRange=function(t,e,r){if(!t)throw new Error("Attribute name must be at least one character");if(isNaN(parseInt(e.toString(),10))||isNaN(parseInt(r.toString(),10)))throw new Error("from and to must be numbers");var n=this.facets.map(function(t){return t.attribute}).indexOf(t);if(n>-1){if(!(this.facets[n]instanceof i.a))throw new Error("Cannot combine piped list and ranges of the same attribute");this.facets[n].update(e,r)}else this.facets.push(new i.a(t,e,r));return this},t.prototype.toggle=function(t,e){var r=this.facets.map(function(t){return t.attribute}).indexOf(t);if(-1===r)this.facets.push(new n.a(t,this.escapeArray([e])));else{if(!(this.facets[r]instanceof n.a))throw new Error("Cannot toggle a range");var i=this.facets[r];i.toggle(this.escapeArray([e])[0]),i.isEmpty()&&this.facets.splice(r,1)}return this},t.prototype.remove=function(t){var e=this.facets.map(function(t){return t.attribute}).indexOf(t);return e>-1&&this.facets.splice(e,1),this},t.prototype.toString=function(){return this.facets.map(function(t){return t.toString()}).join(",")},t.prototype.escapeArray=function(t){var e=["\\",":","|",","],r=new RegExp("["+e.join("\\")+"]","g");return t.map(function(t){return t.replace(r,"\\$&")})},t.prototype.escape=function(t){var e=["\\",":","|",","],r=new RegExp("["+e.join("\\")+"]","g");return t.replace(r,"\\$&")},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e){this.attribute=t,this.values=e}return t.prototype.addValues=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];this.values.indexOf(n)>-1||this.values.push(n)}},t.prototype.toggle=function(t){var e=this.values.indexOf(t);e>-1?this.values.splice(e,1):this.values.push(t)},t.prototype.isEmpty=function(){return 0===this.values.length},t.prototype.toString=function(){return this.attribute+":"+this.values.join("|")},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e,r){this.attribute=t,this.min=e,this.max=r}return t.prototype.update=function(t,e){this.min=t,this.max=e},t.prototype.toString=function(){return this.attribute+":["+this.min+","+this.max+"]"},t}()}])});
//# sourceMappingURL=apptus-esales-api-1.2.4.min.js.map